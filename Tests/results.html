<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<style>
.left {width: 200px; float: left}
.right {float: left;}
.row {clear: both; height: 30px}

.enabled {font-weight: bold}

.button {border: 1px solid black; display: inline; padding: 2px; margin-left: 2px; cursor: pointer;}
.type_all {background-color: white}
.type_oke {background-color: #00FF00}
.type_warn {background-color: orange}
.type_error {background-color: red}

.action_all {background-color: white}

.user_all {background-color: white}

.body {clear: both}
</style>
</head>
<script>
var types = {};
var actions = {};
var users = {};
var typesAvailable = {};
var actionsAvailable = {};
var usersAvailable = {};

function toggleRows(action) {
	if ($(this).hasClass("enabled")) {
		$(this).removeClass("enabled");
	} else {
		$(this).addClass("enabled");
	}

	updateMaps();

	$(".body").find("tr").each(function(){
		var tr = $(this);
		var type = tr.attr("type");
		var action = tr.attr("action");
		var user = tr.attr("user");
		if ((types["all"] != null || types[type] != null) && (actions["all"] != null || actions[action] != null) && (users["all"] != null || users[user] != null)) {
			tr.show();
		} else {
			tr.hide();
		}
	});
}

function updateMaps() {
	types = {};
	actions = {};
	users = {};
	$(".head .types .enabled").each(function(){
		types[$(this).attr("type")] = true;
	});
	$(".head .actions .enabled").each(function(){
		actions[$(this).attr("action")] = true;
	});
	$(".head .users .enabled").each(function(){
		users[$(this).attr("user")] = true;
	});
}

function updateAvailableMaps() {
	typesAvailable = {};
	$(".body").find("[type]").each(function(index, data){
		var type = $(this).attr("type");
		if (types[type] == null) {
			typesAvailable[type] = true;
		}
	});
	
	actionsAvailable = {};
	$(".body").find("[action]").each(function(index, data){
		var action = $(this).attr("action");
		if (actions[action] == null) {
			actionsAvailable[action] = true;
		}
	});
	
	usersAvailable = {};
	$(".body").find("[user]").each(function(index, data){
		var user = $(this).attr("user");
		if (users[user] == null) {
			usersAvailable[user] = true;
		}
	});
}

$(function(){
	$(".head .button").click(toggleRows);
	updateAvailableMaps();
	for (t in typesAvailable) {
		var u = $("<div type=\"" + t + "\" class=\"button type type_" + t + "\">" + t + "</div>");
		u.click(toggleRows);
		$(".head").find(".types .right").append(u);
	}
	for (t in actionsAvailable) {
		var u = $("<div action=\"" + t + "\" class=\"button action action_" + t + "\">" + t + "</div>");
		u.click(toggleRows);
		$(".head").find(".actions .right").append(u);
	}
	for (t in usersAvailable) {
		var u = $("<div user=\"" + t + "\" class=\"button user user_" + t + "\">" + t + "</div>");
		u.click(toggleRows);
		$(".head").find(".users .right").append(u);
	}
});
</script>
<body>
<div class="head">
	<div class="row types">
		<div class="left">Types</div>
		<div class="right">
			<div type="all" class="button type enabled type_all">All</div>
		</div>
	</div>
	
	<div class="row actions">
		<div class="left">Actions</div>
		<div class="right">
			<div action="all" class="button action enabled action_all">All</div>
		</div>
	</div>
	
	<div class="row users">
		<div class="left">Users</div>
		<div class="right">
			<div user="all" class="button user enabled user_all">All</div>
		</div>
	</div>
</div>
<div class="body"><table>
<tr>
<th>#</th>
<th>Virtual User</td>
<th>Action</td>
<th>Result</td>
<th>Message</td>
</tr>
<tr user="Virtual User 0" action="CheckinAction" type="WARN">
<td>0.</td>
<td>Virtual User 0</td>
<td>CheckinAction</td>
<td class="type_WARN">WARN</td>
<td>Error on line 153 (IFC_DOORLININGPROPERTIES is not a known entity) #161=IFC_DOORLININGPROPERTIES('2uYllRMJvCeOb8cUtlgTW5',#24,'Single-Flush:36" x 84" - 2" Inset:36" x 84" - 2" Inset:131666',$,$,$,$,$,$,$,$,$,$,$,$);</td>
</tr>
<tr user="Virtual User 0" action="CreateUserAction" type="OKE">
<td>1.</td>
<td>Virtual User 0</td>
<td>CreateUserAction</td>
<td class="type_OKE">OKE</td>
<td>Creating new user: 1337234130@bimserver.org</td>
</tr>
<tr user="Virtual User 0" action="CheckoutAction" type="OKE">
<td>2.</td>
<td>Virtual User 0</td>
<td>CheckoutAction</td>
<td class="type_OKE">OKE</td>
<td></td>
</tr>
<tr user="Virtual User 0" action="CreateUserAction" type="OKE">
<td>3.</td>
<td>Virtual User 0</td>
<td>CreateUserAction</td>
<td class="type_OKE">OKE</td>
<td>Creating new user: 1643627156@bimserver.org</td>
</tr>
<tr user="Virtual User 0" action="CreateUserAction" type="OKE">
<td>4.</td>
<td>Virtual User 0</td>
<td>CreateUserAction</td>
<td class="type_OKE">OKE</td>
<td>Creating new user: 1982536698@bimserver.org</td>
</tr>
<tr user="Virtual User 0" action="CheckinAction" type="OKE">
<td>5.</td>
<td>Virtual User 0</td>
<td>CheckinAction</td>
<td class="type_OKE">OKE</td>
<td>Checking in new revision on project Project 1738448651 (000.ifc) sync: true, merge: false</td>
</tr>
<tr user="Virtual User 0" action="CheckoutAction" type="WARN">
<td>6.</td>
<td>Virtual User 0</td>
<td>CheckoutAction</td>
<td class="type_WARN">WARN</td>
<td>Only IFC or IFCXML allowed when checking out</td>
</tr>
